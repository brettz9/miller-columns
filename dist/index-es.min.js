function loadStylesheets(e,{before:t,after:n,favicon:c,canvas:s,image:a=!0,acceptErrors:r}={}){return e=Array.isArray(e)?e:[e],Promise.all(e.map(function(e){let i={};Array.isArray(e)&&([e,i={}]=e);let{favicon:l=c}=i;const{before:o=t,after:d=n,canvas:u=s,image:f=a}=i;function h(){o?o.before(m):d?d.after(m):document.head.appendChild(m)}const m=document.createElement("link");return new Promise((t,n)=>{let c=n;if(r&&(c="function"==typeof r?c=>{r({error:c,stylesheetURL:e,options:i,resolve:t,reject:n})}:t),e.endsWith(".css")?l=!1:e.endsWith(".ico")&&(l=!0),l){if(m.rel="shortcut icon",m.type="image/x-icon",!1===f)return m.href=e,h(),void t(m);const c=document.createElement("canvas");c.width=16,c.height=16;const s=c.getContext("2d"),a=document.createElement("img");return a.addEventListener("error",e=>{n(e)}),a.addEventListener("load",()=>{s.drawImage(a,0,0),m.href=u?c.toDataURL("image/x-icon"):e,h(),t(m)}),void(a.src=e)}m.rel="stylesheet",m.type="text/css",m.href=e,h(),m.addEventListener("error",e=>{c(e)}),m.addEventListener("load",()=>{t(m)})})}))}const moduleURL=new URL("node_modules/miller-columns/src/index.js",location),defaultCSSURL=new URL("../miller-columns.css",moduleURL).href;function escapeRegex(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}var index=async function(e,{namespace:t="miller",stylesheets:n=["@default"]}={}){let c;const s=`ul:not(.${t}-no-columns),ol:not(.${t}-no-columns)`,a="li";function r(){return e(`.${t}-column > .${t}-selected`)}function i(){const n=e(`.${t}-breadcrumbs`).empty();r().each(function(){const c=e(this);e(`<span class="${t}-breadcrumb">`).text(c.text().trim()).click(function(){c.click()}).appendTo(n)})}function l(t,n){let s=0;r().not(t).each(function(){s+=e(this).outerWidth(!0)}),n.stop().animate({scrollLeft:s},c.delay)}function o(){e(`.${t}-column:gt(0)`).addClass(`${t}-collapse`)}function d(){return r().last()}function u(e){f(e),function(e){l(null,e)}(e)}function f(n){o(),r().removeClass(`${t}-selected`),i(),c.reset(n),c.preview&&e(`.${t}-preview`).remove()}function h(){d().next().click()}function m(n){let c,s="";return function(r){const{key:i}=r;let l=!1;switch(i){case"Escape":u(n);break;case"ArrowUp":d().prev().click(),l=!0;break;case"ArrowDown":h(),l=!0;break;case"ArrowLeft":!function(){const e=d().data(`${t}-ancestor`);e&&e.click()}(),l=!0;break;case"ArrowRight":!function(){const e=d().data(`${t}-child`);e?e.children(a).first().click():h()}(),l=!0;break;default:if(1===i.length){!function(e){const t=new Date;!c||t-c<500?s+=e:s=e,c=t}(i),n.find(`${a}.${t}-selected`).last().siblings().filter(function(){return new RegExp("^"+escapeRegex(s),"i").test(e(this).text().trim())}).first().click()}l=!0}l&&0===d().length&&e(`.${t}-column`).first().children().first().click(),l&&r.preventDefault()}}n&&await loadStylesheets(n.map(e=>"@default"===e?defaultCSSURL:e)),e.fn.millerColumns=function(n){const r={current:e=>{},reset:e=>{},preview:e=>{},breadcrumb:i,animation:l,delay:500,resetOnOutsideClick:!0};return c=e.extend(r,n),this.each(function(){const n=e(this);!function(n){const c=[];let r;for(c.push(n.children());c.length;)(r=c.shift()).children(a).each(function(a,r){const i=e(this),l=i.children(s),o=i.parent().parent();o.length&&null==i.data(`${t}-ancestor`)&&e(this).siblings().addBack().data(`${t}-ancestor`,o),l.length&&(c.push(l),e(this).data(`${t}-child`,l).addClass(`${t}-parent`)),e(this).parent(s).appendTo(n).addClass(`${t}-column`)})}(n),o(),n.find(a).on("click",function(s){const a=e(this);f(n);const r=a.data(`${t}-child`);let i=a;for(r&&r.removeClass(`${t}-collapse`).children().removeClass(`${t}-selected`);i;)i.addClass(`${t}-selected`).parent().removeClass(`${t}-collapse`),i=i.data(`${t}-ancestor`);if(c.animation.call(this,a,n),c.breadcrumb.call(this),c.current.call(this,a,n),c.preview){if(a.hasClass(`${t}-selected`)&&!a.hasClass(`${t}-parent`)){const e=c.preview.call(this,a,n);a.parent().parent().append(`<ul class="${t}-column ${t}-preview">\n                                <li>${e}</li>\n                            </ul>`)}}s.stopPropagation()}),n.on("keydown",m(n)),n.on("click",()=>{c.resetOnOutsideClick&&u(n)})})}};export default index;
