function loadStylesheets(e,{before:t,after:n,favicon:c,canvas:o,image:l=!0}={}){return e=Array.isArray(e)?e:[e],Promise.all(e.map(function(e){function a(){t?t.before(s):n?n.after(s):document.head.appendChild(s)}const s=document.createElement("link");return new Promise((t,n)=>{if(e.endsWith(".ico")&&(c=!0),c){if(s.rel="shortcut icon",s.type="image/x-icon",!1===l)return s.href=e,a(),void t(s);const c=document.createElement("canvas");c.width=16,c.height=16;const i=c.getContext("2d"),r=document.createElement("img");return r.addEventListener("error",e=>{n(e)}),r.addEventListener("load",()=>{i.drawImage(r,0,0),s.href=o?c.toDataURL("image/x-icon"):e,a(),t(s)}),void(r.src=e)}s.rel="stylesheet",s.type="text/css",s.href=e,a(),s.addEventListener("error",e=>{n(e)}),s.addEventListener("load",()=>{t(s)})})}))}const moduleURL=new URL("node_modules/miller-columns/src/index.js",location),defaultCSSURL=new URL("../miller-columns.css",moduleURL).href;function escapeRegex(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}var index=async function(e,{stylesheets:t=["@default"]}={}){let n;const c="ul:not(.no-columns),ol:not(.no-columns)",o="li";function l(){return e(".column > .selected")}function a(){const t=e("div.breadcrumb").empty();l().each(function(){const n=e(this);e("<span>").text(n.text().trim()).click(function(){n.click()}).appendTo(t)})}function s(t,c){let o=0;l().not(t).each(function(){o+=e(this).outerWidth(!0)}),c.stop().animate({scrollLeft:o},n.delay)}function i(){e(".column:gt(0)").addClass("collapse")}function r(){return l().last()}function d(e){u(e),function(e){s(null,e)}(e)}function u(e){i(),l().removeClass("selected"),a(),n.current(null,e)}function f(){r().next().click()}function h(t){let n,c="";return function(l){const{key:a}=l;let s=!1;switch(a){case"Escape":d(t);break;case"ArrowUp":r().prev().click(),s=!0;break;case"ArrowDown":f(),s=!0;break;case"ArrowLeft":!function(){const e=r().data("ancestor");e&&e.click()}(),s=!0;break;case"ArrowRight":!function(){const e=r().data("child");e?e.children(o).first().click():f()}(),s=!0;break;default:if(1===a.length){!function(e){const t=new Date;!n||t-n<500?c+=e:c=e,n=t}(a),t.find("ul:not(.no-columns,.collapse),ol:not(.no-columns,.collapse) > li.selected").last().parent().children().children("*:not(ul:not(.no-columns))").filter(function(){return new RegExp("^"+escapeRegex(c),"i").test(e(this).text().trim())}).first().click()}s=!0}s&&0===r().length&&e(".column").first().children().first().click(),s&&l.preventDefault()}}t&&await loadStylesheets(t.map(e=>"@default"===e?defaultCSSURL:e)),e.fn.millerColumns=function(t){const l={current:e=>{},breadcrumb:a,animation:s,delay:500,resetOnOutsideClick:!0};return n=e.extend(l,t),this.each(function(){const t=e(this);!function(t){const n=[];let l;for(n.push(t.children());n.length;)(l=n.shift()).children(o).each(function(o,l){const a=e(this),s=a.children(c),i=a.parent().parent();i.length&&null==a.data("ancestor")&&e(this).siblings().addBack().data("ancestor",i),s.length&&(n.push(s),e(this).data("child",s).addClass("parent")),e(this).parent(c).appendTo(t).addClass("column")})}(t),i(),t.find(o).on("click",function(c){const o=e(this);u(t);const l=o.data("child");let a=o;for(l&&l.removeClass("collapse").children().removeClass("selected");a;)a.addClass("selected").parent().removeClass("collapse"),a=a.data("ancestor");n.animation.call(this,o,t),n.breadcrumb.call(this),n.current.call(this,o,t),c.stopPropagation()}),t.on("keydown",h(t)),t.on("click",()=>{n.resetOnOutsideClick&&d(t)})})}};export default index;
