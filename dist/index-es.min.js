function e(e,{before:t,after:n,favicon:r,canvas:a,image:c=!0,acceptErrors:o}={}){return e=Array.isArray(e)?e:[e],Promise.all(e.map((e=>function(e){let l,s={};Array.isArray(e)?[l,s={}]=e:l=e;let{favicon:i=r}=s;const{before:d=t,after:u=n,canvas:f=a,image:h=c}=s;function p(){d?d.before(m):u?u.after(m):document.head.append(m)}const m=document.createElement("link");return new Promise(((e,t)=>{let n=t;if(o&&(n="function"==typeof o?n=>{o({error:n,stylesheetURL:l,options:s,resolve:e,reject:t})}:e),l.endsWith(".css")?i=!1:l.endsWith(".ico")&&(i=!0),i){if(m.rel="shortcut icon",m.type="image/x-icon",!1===h)return m.href=l,p(),void e(m);const n=document.createElement("canvas");n.width=16,n.height=16;const r=n.getContext("2d"),a=document.createElement("img");return a.addEventListener("error",(e=>{t(e)})),a.addEventListener("load",(()=>{if(!r)throw new Error("Canvas context could not be found");r.drawImage(a,0,0),m.href=f?n.toDataURL("image/x-icon"):l,p(),e(m)})),void(a.src=l)}m.rel="stylesheet",m.type="text/css",m.href=l,p(),m.addEventListener("error",(e=>{n(e)})),m.addEventListener("load",(()=>{e(m)}))}))}(e))))}
/**
 * MIT License.
 *
 * @copyright 2014 White Magic Software, Inc.
 * @copyright 2018 Brett Zamir
 */const t=new URL("../miller-columns.css",import.meta.url).href;async function n(n,{namespace:r="miller",stylesheets:a=["@default"]}={}){let c;const o=`ul:not(.${r}-no-columns),ol:not(.${r}-no-columns)`,l="li";function s(){return n(`.${r}-column > .${r}-selected`)}function i(e){const t=n(`.${r}-breadcrumbs`).empty();c.breadcrumbRoot&&n(`<span class="${r}-breadcrumb ${r}-breadcrumb-root">`).text(c.breadcrumbRoot).on("click",(function(){e&&($(e),p(e))})).appendTo(t),s().each((function(){const e=n(this);n(`<span class="${r}-breadcrumb">`).text(e.text().trim()).on("click",(function(){e.trigger("click")})).appendTo(t)}))}function d(e,t){let a=0;(e?s().not(e):s()).each((function(){a+=n(this).outerWidth(!0)})),t.stop().animate({scrollLeft:a},c.delay,(function(){t.find(`.${r}-column:not(.${r}-collapse)`).last()[0].scrollLeft=a,c.scroll&&c.scroll.call(this,e,t)}))}function u(e,t){const a=[];let c;for(a.push(t||e.children());a.length;)c=a.shift(),c.children(l).each((function(){const t=n(this),c=t.children(o),s=t.parent().parent();s.length&&s.is(l)&&null==t.data(`${r}-ancestor`)&&n(this).siblings().addBack().data(`${r}-ancestor`,s),c.length&&(a.push(c),n(this).data(`${r}-child`,c).addClass(`${r}-parent`)),n(this).parent(o).appendTo(e).addClass(`${r}-column`)}))}function f(){n(`.${r}-column:gt(0)`).addClass(`${r}-collapse`)}function h(){return s().last()}function p(e){d(null,e)}function m(e){$(e),p(e)}function $(e){f(),s().removeClass(`${r}-selected`),i(e),c.reset(e),c.preview&&n(`.${r}-preview`).remove()}function g(){const e=h().next();e[0]?.scrollIntoView({block:"nearest",inline:"start"}),e.trigger("click")}function v(e){let t,a="";return function(c){const o=c.key;let s=!1;switch(o){case"Escape":m(e);break;case"ArrowUp":!function(){const e=h().prev();e[0]?.scrollIntoView({block:"nearest"}),e.trigger("click")}(),s=!0;break;case"ArrowDown":g(),s=!0;break;case"ArrowLeft":!function(){const e=h(),t=e.data(`${r}-ancestor`),n=e.data(`${r}-child`);(!n||n.hasClass(`${r}-collapse`)||t)&&t&&(t[0]?.scrollIntoView({block:"nearest"}),t.trigger("click"))}(),s=!0;break;case"ArrowRight":!function(){const e=h().data(`${r}-child`);if(e){const t=e.children(l).first();t[0]?.scrollIntoView({block:"nearest"}),t.trigger("click")}else g()}(),s=!0;break;default:if(!c.metaKey&&!c.altKey){if(1===o.length){!function(e){const n=Date.now();!t||n-t<500?a+=e:a=e,t=n}(o);const c=e.find(`${l}.${r}-selected`).last().siblings().filter((function(){return new RegExp("^"+(e=a,e.replaceAll(/[\-\[\]\{\}\(\)*+?.,\\^$\|#\s]/gv,String.raw`\$&`)),"iv").test(n(this).text().trim());var e})).first();c[0]?.scrollIntoView({block:"nearest"}),c.trigger("click")}s=!0}}s&&0===h().length&&n(`.${r}-column`).first().children().first().trigger("click"),s&&c.preventDefault()}}return a&&await e(a.map((e=>"@default"===e?t:e))),n.fn.millerColumns=function(e){const t={current(e){},reset(e){},preview:null,breadcrumbRoot:"Root",breadcrumb:i,animation:d,delay:500,outsideClickBehavior:"select-parent"};c=n.extend(t,e);const a=this.each((function(){const e=n(this),t=e.html();e.data(`${r}-original-html`,t),u(e),f(),i(e);const a=v(e);e.on("click",l,(function(t){const a=n(this);$(e);const o=a.data(`${r}-child`);let l=a;for(o&&(o[0]?.scrollIntoView({block:"nearest"}),o.removeClass(`${r}-collapse`).children().removeClass(`${r}-selected`));l;)l.addClass(`${r}-selected`).parent().removeClass(`${r}-collapse`),l=l.data(`${r}-ancestor`);if(c.animation.call(this,a,e),c.breadcrumb.call(this,e),c.current.call(this,a,e),c.preview){if(a.hasClass(`${r}-selected`)&&!a.hasClass(`${r}-parent`)){const t=c.preview.call(this,a,e);a.parent().parent().append(`<ul class="${r}-column ${r}-preview">\n                <li>${t}</li>\n              </ul>`)}}t.stopPropagation()})),e[0].addEventListener("keydown",a),e.on("click",(t=>{switch(c.outsideClickBehavior){case"reset":m(e);break;case"select-parent":{const e=document.caretPositionFromPoint(t.clientX,t.clientY),a=e?.offsetNode;let c=1===a?.nodeType?a:a?.parentElement;for(;c;){if(c.matches(`ul.${r}-column:not(.${r}-collapse)`)){n(c).prevAll(`ul.${r}-column:not(.${r}-collapse)`).first().find(`li.${r}-selected`).trigger("click");break}c=c.parentElement}break}}})),e.data(`${r}-keypress-handler`,a)}));return a.addItem=function(e,t){const c="string"==typeof e?n(e):e,l=a;if(t){let e=t.data(`${r}-child`);e?(e.append(c),c.data(`${r}-ancestor`,t)):(e=n("<ul>").append(c),t.append(e),t.data(`${r}-child`,e).addClass(`${r}-parent`),c.data(`${r}-ancestor`,t),u(l,e),e=t.data(`${r}-child`));const a=c.children(o);a.length&&(c.data(`${r}-child`,a).addClass(`${r}-parent`),u(l,a))}else{const e=l.find(`.${r}-column`).first();if(e.length){e.append(c);const t=c.children(o);t.length&&(c.data(`${r}-child`,t).addClass(`${r}-parent`),u(l,t))}else{const e=n("<ul>").append(c);l.append(e),u(l,e)}}return c},a.refreshChildren=function(e,t){if(!e||!e.length)return e;const c=e.data(`${r}-child`);c&&c.length&&(c.remove(),e.removeData(`${r}-child`).removeClass(`${r}-parent`));const o=t.map((e=>"string"==typeof e?n(e):e)),l=n("<ul>").append(o);return e.append(l),u(a,l),e.trigger("click"),e},a.destroy=function(){return a.each((function(){const e=n(this),t=e.data(`${r}-keypress-handler`);t&&this.removeEventListener("keydown",t),e.off("click"),e.find(`.${r}-column`).removeClass(`${r}-column ${r}-collapse`),e.find(`.${r}-parent`).removeClass(`${r}-parent`),e.find(`.${r}-selected`).removeClass(`${r}-selected`),e.find("li").each((function(){const e=n(this);e.removeData(`${r}-ancestor`),e.removeData(`${r}-child`)})),e.find(`.${r}-preview`).remove();const a=e.data(`${r}-original-html`);a&&(e.html(a),e.removeData(`${r}-original-html`)),e.removeData(`${r}-keypress-handler`)})),delete a.addItem,delete a.destroy,delete a.refreshChildren,a},a},n}export{n as default};
