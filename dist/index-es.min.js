function e(e,{before:t,after:n,favicon:a,canvas:r,image:s=!0,acceptErrors:c}={}){return e=Array.isArray(e)?e:[e],Promise.all(e.map((e=>function(e){let l,i={};Array.isArray(e)?[l,i={}]=e:l=e;let{favicon:o=a}=i;const{before:d=t,after:u=n,canvas:f=r,image:h=s}=i;function p(){d?d.before(m):u?u.after(m):document.head.append(m)}const m=document.createElement("link");return new Promise(((e,t)=>{let n=t;if(c&&(n="function"==typeof c?n=>{c({error:n,stylesheetURL:l,options:i,resolve:e,reject:t})}:e),l.endsWith(".css")?o=!1:l.endsWith(".ico")&&(o=!0),o){if(m.rel="shortcut icon",m.type="image/x-icon",!1===h)return m.href=l,p(),void e(m);const n=document.createElement("canvas");n.width=16,n.height=16;const a=n.getContext("2d"),r=document.createElement("img");return r.addEventListener("error",(e=>{t(e)})),r.addEventListener("load",(()=>{if(!a)throw new Error("Canvas context could not be found");a.drawImage(r,0,0),m.href=f?n.toDataURL("image/x-icon"):l,p(),e(m)})),void(r.src=l)}m.rel="stylesheet",m.type="text/css",m.href=l,p(),m.addEventListener("error",(e=>{n(e)})),m.addEventListener("load",(()=>{e(m)}))}))}(e))))}
/**
 * MIT License.
 *
 * @copyright 2014 White Magic Software, Inc.
 * @copyright 2018 Brett Zamir
 */const t=new URL("../miller-columns.css",import.meta.url).href;async function n(n,{namespace:a="miller",stylesheets:r=["@default"]}={}){let s;const c=`ul:not(.${a}-no-columns),ol:not(.${a}-no-columns)`,l="li";function i(){return n(`.${a}-column > .${a}-selected`)}function o(){const e=n(`.${a}-breadcrumbs`).empty();i().each((function(){const t=n(this);n(`<span class="${a}-breadcrumb">`).text(t.text().trim()).on("click",(function(){t.trigger("click")})).appendTo(e)}))}function d(e,t){let r=0;(e?i().not(e):i()).each((function(){r+=n(this).outerWidth(!0)})),t.stop().animate({scrollLeft:r},s.delay,(function(){t.find(`.${a}-column:not(.${a}-collapse)`).last()[0].scrollLeft=r,s.scroll&&s.scroll.call(this,e,t)}))}function u(e,t){const r=[];let s;for(r.push(t||e.children());r.length;)s=r.shift(),s.children(l).each((function(t,s){const i=n(this),o=i.children(c),d=i.parent().parent();d.length&&d.is(l)&&null==i.data(`${a}-ancestor`)&&n(this).siblings().addBack().data(`${a}-ancestor`,d),o.length&&(r.push(o),n(this).data(`${a}-child`,o).addClass(`${a}-parent`)),n(this).parent(c).appendTo(e).addClass(`${a}-column`)}))}function f(){n(`.${a}-column:gt(0)`).addClass(`${a}-collapse`)}function h(){return i().last()}function p(e){m(e),function(e){d(null,e)}(e)}function m(e){f(),i().removeClass(`${a}-selected`),o(),s.reset(e),s.preview&&n(`.${a}-preview`).remove()}function $(){h().next().trigger("click")}function g(e){let t,r="";return function(s){const c=s.key;let i=!1;switch(c){case"Escape":p(e);break;case"ArrowUp":h().prev().trigger("click"),i=!0;break;case"ArrowDown":$(),i=!0;break;case"ArrowLeft":!function(){const e=h(),t=e.data(`${a}-ancestor`),n=e.data(`${a}-child`);(!n||n.hasClass(`${a}-collapse`)||t)&&t&&t.trigger("click")}(),i=!0;break;case"ArrowRight":!function(){const e=h().data(`${a}-child`);e?e.children(l).first().trigger("click"):$()}(),i=!0;break;default:if(1===c.length){!function(e){const n=Date.now();!t||n-t<500?r+=e:r=e,t=n}(c);e.find(`${l}.${a}-selected`).last().siblings().filter((function(){return new RegExp("^"+(e=r,e.replaceAll(/[\-\[\]\{\}\(\)*+?.,\\^$\|#\s]/gv,String.raw`\$&`)),"iv").test(n(this).text().trim());var e})).first().trigger("click")}i=!0}i&&0===h().length&&n(`.${a}-column`).first().children().first().trigger("click"),i&&s.preventDefault()}}return r&&await e(r.map((e=>"@default"===e?t:e))),n.fn.millerColumns=function(e){const t={current(e){},reset(e){},preview:null,breadcrumb:o,animation:d,delay:500,resetOnOutsideClick:!0};s=n.extend(t,e);const r=this.each((function(){const e=n(this),t=e.html();e.data(`${a}-original-html`,t),u(e),f();const r=g(e);e.on("click",l,(function(t){const r=n(this);m(e);const c=r.data(`${a}-child`);let l=r;for(c&&c.removeClass(`${a}-collapse`).children().removeClass(`${a}-selected`);l;)l.addClass(`${a}-selected`).parent().removeClass(`${a}-collapse`),l=l.data(`${a}-ancestor`);if(s.animation.call(this,r,e),s.breadcrumb.call(this),s.current.call(this,r,e),s.preview){if(r.hasClass(`${a}-selected`)&&!r.hasClass(`${a}-parent`)){const t=s.preview.call(this,r,e);r.parent().parent().append(`<ul class="${a}-column ${a}-preview">\n                                <li>${t}</li>\n                            </ul>`)}}t.stopPropagation()})),e[0].addEventListener("keydown",r),e.on("click",(()=>{s.resetOnOutsideClick&&p(e)})),e.data(`${a}-keypress-handler`,r)}));return r.addItem=function(e,t){const s="string"==typeof e?n(e):e,l=r;if(t){let e=t.data(`${a}-child`);e?(e.append(s),s.data(`${a}-ancestor`,t)):(e=n("<ul>").append(s),t.append(e),t.data(`${a}-child`,e).addClass(`${a}-parent`),s.data(`${a}-ancestor`,t),u(l,e),e=t.data(`${a}-child`));const r=s.children(c);r.length&&(s.data(`${a}-child`,r).addClass(`${a}-parent`),u(l,r))}else{const e=l.find(`.${a}-column`).first();if(e.length){e.append(s);const t=s.children(c);t.length&&(s.data(`${a}-child`,t).addClass(`${a}-parent`),u(l,t))}else{const e=n("<ul>").append(s);l.append(e),u(l,e)}}return s},r.destroy=function(){return r.each((function(){const e=n(this),t=e.data(`${a}-keypress-handler`);t&&this.removeEventListener("keydown",t),e.off("click"),e.find(`.${a}-column`).removeClass(`${a}-column ${a}-collapse`),e.find(`.${a}-parent`).removeClass(`${a}-parent`),e.find(`.${a}-selected`).removeClass(`${a}-selected`),e.find("li").each((function(){const e=n(this);e.removeData(`${a}-ancestor`),e.removeData(`${a}-child`)})),e.find(`.${a}-preview`).remove();const r=e.data(`${a}-original-html`);r&&(e.html(r),e.removeData(`${a}-original-html`)),e.removeData(`${a}-keypress-handler`)})),delete r.addItem,delete r.destroy,r},r},n}export{n as default};
