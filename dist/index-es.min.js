function e(e,{before:t,after:n,favicon:r,canvas:c,image:a=!0,acceptErrors:s}={}){return e=Array.isArray(e)?e:[e],Promise.all(e.map((e=>function(e){let i,l={};Array.isArray(e)?[i,l={}]=e:i=e;let{favicon:o=r}=l;const{before:d=t,after:u=n,canvas:f=c,image:h=a}=l;function p(){d?d.before(m):u?u.after(m):document.head.append(m)}const m=document.createElement("link");return new Promise(((e,t)=>{let n=t;if(s&&(n="function"==typeof s?n=>{s({error:n,stylesheetURL:i,options:l,resolve:e,reject:t})}:e),i.endsWith(".css")?o=!1:i.endsWith(".ico")&&(o=!0),o){if(m.rel="shortcut icon",m.type="image/x-icon",!1===h)return m.href=i,p(),void e(m);const n=document.createElement("canvas");n.width=16,n.height=16;const r=n.getContext("2d"),c=document.createElement("img");return c.addEventListener("error",(e=>{t(e)})),c.addEventListener("load",(()=>{if(!r)throw new Error("Canvas context could not be found");r.drawImage(c,0,0),m.href=f?n.toDataURL("image/x-icon"):i,p(),e(m)})),void(c.src=i)}m.rel="stylesheet",m.type="text/css",m.href=i,p(),m.addEventListener("error",(e=>{n(e)})),m.addEventListener("load",(()=>{e(m)}))}))}(e))))}
/**
 * MIT License.
 *
 * @copyright 2014 White Magic Software, Inc.
 * @copyright 2018 Brett Zamir
 */const t=new URL("../miller-columns.css",import.meta.url).href;async function n(n,{namespace:r="miller",stylesheets:c=["@default"]}={}){let a;const s=`ul:not(.${r}-no-columns),ol:not(.${r}-no-columns)`,i="li";function l(){return n(`.${r}-column > .${r}-selected`)}function o(){const e=n(`.${r}-breadcrumbs`).empty();l().each((function(){const t=n(this);n(`<span class="${r}-breadcrumb">`).text(t.text().trim()).on("click",(function(){t.trigger("click")})).appendTo(e)}))}function d(e,t){let c=0;(e?l().not(e):l()).each((function(){c+=n(this).outerWidth(!0)})),t.stop().animate({scrollLeft:c},a.delay,(function(){t.find(`.${r}-column:not(.${r}-collapse)`).last()[0].scrollLeft=c,a.scroll&&a.scroll.call(this,e,t)}))}function u(e,t){const c=[];let a;for(c.push(t||e.children());c.length;)a=c.shift(),a.children(i).each((function(t,a){const i=n(this),l=i.children(s),o=i.parent().parent();o.length&&null==i.data(`${r}-ancestor`)&&n(this).siblings().addBack().data(`${r}-ancestor`,o),l.length&&(c.push(l),n(this).data(`${r}-child`,l).addClass(`${r}-parent`)),n(this).parent(s).appendTo(e).addClass(`${r}-column`)}))}function f(){n(`.${r}-column:gt(0)`).addClass(`${r}-collapse`)}function h(){return l().last()}function p(e){m(e),function(e){d(null,e)}(e)}function m(e){f(),l().removeClass(`${r}-selected`),o(),a.reset(e),a.preview&&n(`.${r}-preview`).remove()}function $(){h().next().trigger("click")}function g(e){let t,c="";return function(a){const s=a.key;let l=!1;switch(s){case"Escape":p(e);break;case"ArrowUp":h().prev().trigger("click"),l=!0;break;case"ArrowDown":$(),l=!0;break;case"ArrowLeft":!function(){const e=h().data(`${r}-ancestor`);e&&e.trigger("click")}(),l=!0;break;case"ArrowRight":!function(){const e=h().data(`${r}-child`);e?e.children(i).first().trigger("click"):$()}(),l=!0;break;default:if(1===s.length){!function(e){const n=Date.now();!t||n-t<500?c+=e:c=e,t=n}(s);e.find(`${i}.${r}-selected`).last().siblings().filter((function(){return new RegExp("^"+(e=c,e.replaceAll(/[\-\[\]\{\}\(\)*+?.,\\^$\|#\s]/gv,String.raw`\$&`)),"iv").test(n(this).text().trim());var e})).first().trigger("click")}l=!0}l&&0===h().length&&n(`.${r}-column`).first().children().first().trigger("click"),l&&a.preventDefault()}}return c&&await e(c.map((e=>"@default"===e?t:e))),n.fn.millerColumns=function(e){const t={current(e){},reset(e){},preview:null,breadcrumb:o,animation:d,delay:500,resetOnOutsideClick:!0};a=n.extend(t,e);const c=this.each((function(){const e=n(this);u(e),f(),e.on("click",i,(function(t){const c=n(this);m(e);const s=c.data(`${r}-child`);let i=c;for(s&&s.removeClass(`${r}-collapse`).children().removeClass(`${r}-selected`);i;)i.addClass(`${r}-selected`).parent().removeClass(`${r}-collapse`),i=i.data(`${r}-ancestor`);if(a.animation.call(this,c,e),a.breadcrumb.call(this),a.current.call(this,c,e),a.preview){if(c.hasClass(`${r}-selected`)&&!c.hasClass(`${r}-parent`)){const t=a.preview.call(this,c,e);c.parent().parent().append(`<ul class="${r}-column ${r}-preview">\n                                <li>${t}</li>\n                            </ul>`)}}t.stopPropagation()})),e[0].addEventListener("keydown",g(e)),e.on("click",(()=>{a.resetOnOutsideClick&&p(e)}))}));return c.addItem=function(e,t){const a="string"==typeof e?n(e):e,l=c;if(t){let e=t.data(`${r}-child`);e||(e=n("<ul>"),t.append(e),t.data(`${r}-child`,e).addClass(`${r}-parent`)),e.append(a),e.children(i).data(`${r}-ancestor`,t);const c=a.children(s);c.length&&(a.data(`${r}-child`,c).addClass(`${r}-parent`),u(l,c))}else{const e=l.find(`.${r}-column`).first();if(e.length){e.append(a);const t=a.children(s);t.length&&(a.data(`${r}-child`,t).addClass(`${r}-parent`),u(l,t))}else{const e=n("<ul>").append(a);l.append(e),u(l,e)}}return a},c},n}export{n as default};
