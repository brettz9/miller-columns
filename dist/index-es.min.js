function escapeRegex(n){return n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function index(n){let t;const e="ul:not(.no-columns),ol:not(.no-columns)",c="li";function l(){return n(".column > .selected")}function o(){const t=n("div.breadcrumb").empty();l().each(function(){const e=n(this);n("<span>").text(e.text().trim()).click(function(){e.click()}).appendTo(t)})}function i(e,c){let o=0;l().not(e).each(function(){o+=n(this).outerWidth(!0)}),c.stop().animate({scrollLeft:o},t.delay)}function s(){n(".column:gt(0)").addClass("collapse")}function a(){return l().last()}function r(n){u(n),function(n){i(null,n)}(n)}function u(n){s(),l().removeClass("selected"),o(),t.current(null,n)}function d(){a().next().click()}function f(t){let e,l="";return function(o){const{key:i}=o;!function(n){const t=new Date;!e||t-e<500?l+=n:l=n,e=t}(i);let s=!1;switch(i){case"Escape":r(t);break;case"ArrowUp":a().prev().click(),s=!0;break;case"ArrowDown":d(),s=!0;break;case"ArrowLeft":!function(){const n=a().data("ancestor");n&&n.click()}(),s=!0;break;case"ArrowRight":!function(){const n=a().data("child");n?n.children(c).first().click():d()}(),s=!0;break;default:if(/^\w/i.test(l)){t.find("ul:not(.no-columns,.collapse),ol:not(.no-columns,.collapse) > li.selected").last().parent().children().children("*:not(ul:not(.no-columns))").filter(function(){return new RegExp("^"+escapeRegex(l),"i").test(n(this).text().trim())}).first().click()}s=!0}s&&0===a().length&&n(".column").first().children().first().click(),s&&o.preventDefault()}}n.fn.millerColumns=function(l){const a={current:n=>{},breadcrumb:o,animation:i,delay:500,resetOnOutsideClick:!0};return t=n.extend(a,l),this.each(function(){const l=n(this);!function(t){const l=[];let o;for(l.push(t.children());l.length;)(o=l.shift()).children(c).each(function(c,o){const i=n(this),s=i.children(e),a=i.parent().parent();a.length&&null==i.data("ancestor")&&n(this).siblings().addBack().data("ancestor",a),s.length&&(l.push(s),n(this).data("child",s).addClass("parent")),n(this).parent(e).appendTo(t).addClass("column")})}(l),s(),l.find(c).on("click",function(e){const c=n(this);u(l);const o=c.data("child");let i=c;for(o&&o.removeClass("collapse").children().removeClass("selected");i;)i.addClass("selected").parent().removeClass("collapse"),i=i.data("ancestor");t.animation.call(this,c,l),t.breadcrumb.call(this),t.current.call(this,c,l),e.stopPropagation()}),l.on("keydown",f(l)),l.on("click",()=>{t.resetOnOutsideClick&&r(l)})})}}export default index;
