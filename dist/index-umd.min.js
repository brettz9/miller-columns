!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.addMillerColumnPlugin=t()}(this,function(){"use strict";return function(n){let t;const e="ul:not(.no-columns),ol:not(.no-columns)",c="li";function o(){return n(".column > .selected")}function l(){const t=n("div.breadcrumb").empty();o().each(function(){const e=n(this);n("<span>").text(e.text().trim()).click(function(){e.click()}).appendTo(t)})}function i(e,c){let l=0;o().not(e).each(function(){l+=n(this).outerWidth(!0)}),c.stop().animate({scrollLeft:l},t.delay)}function s(){n(".column:gt(0)").addClass("collapse")}function a(){return o().last()}function r(n){u(n),function(n){i(null,n)}(n)}function u(n){s(),o().removeClass("selected"),l(),t.current(null,n)}function d(){a().next().click()}function f(t){let e,o="";return function(l){const{key:i}=l;!function(n){const t=new Date;!e||t-e<500?o+=n:o=n,e=t}(i);let s=!1;switch(i){case"Escape":r(t);break;case"ArrowUp":a().prev().click(),s=!0;break;case"ArrowDown":d(),s=!0;break;case"ArrowLeft":!function(){const n=a().data("ancestor");n&&n.click()}(),s=!0;break;case"ArrowRight":!function(){const n=a().data("child");n?n.children(c).first().click():d()}(),s=!0;break;default:/^\w/i.test(o)&&t.find("ul:not(.no-columns,.collapse),ol:not(.no-columns,.collapse) > li.selected").last().parent().children().children("*:not(ul:not(.no-columns))").filter(function(){return new RegExp("^"+(t=o,t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")),"i").test(n(this).text().trim());var t}).first().click(),s=!0}s&&0===a().length&&n(".column").first().children().first().click(),s&&l.preventDefault()}}n.fn.millerColumns=function(o){const a={current:n=>{},breadcrumb:l,animation:i,delay:500,resetOnOutsideClick:!0};return t=n.extend(a,o),this.each(function(){const o=n(this);!function(t){const o=[];let l;for(o.push(t.children());o.length;)(l=o.shift()).children(c).each(function(c,l){const i=n(this),s=i.children(e),a=i.parent().parent();a.length&&null==i.data("ancestor")&&n(this).siblings().addBack().data("ancestor",a),s.length&&(o.push(s),n(this).data("child",s).addClass("parent")),n(this).parent(e).appendTo(t).addClass("column")})}(o),s(),o.find(c).on("click",function(e){const c=n(this);u(o);const l=c.data("child");let i=c;for(l&&l.removeClass("collapse").children().removeClass("selected");i;)i.addClass("selected").parent().removeClass("collapse"),i=i.data("ancestor");t.animation.call(this,c,o),t.breadcrumb.call(this),t.current.call(this,c,o),e.stopPropagation()}),o.on("keydown",f(o)),o.on("click",()=>{t.resetOnOutsideClick&&r(o)})})}}});
