!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.addMillerColumnPlugin=t()}(this,function(){"use strict";return function(n){let t;const e="ul:not(.no-columns),ol:not(.no-columns)",c="li";function i(){return n(".column > .selected")}function o(){const t=n("div.breadcrumb").empty();i().each(function(){const e=n(this);n("<span>").text(e.text().trim()).click(function(){e.click()}).appendTo(t)})}function l(e,c){let o=0;i().not(e).each(function(){o+=n(this).outerWidth(!0)}),c.stop().animate({scrollLeft:o},t.delay)}function s(){n(".column:gt(0)").addClass("collapse")}function a(){return i().last()}function r(n){u(n),function(n){l(null,n)}(n)}function u(n){s(),i().removeClass("selected"),o(),t.current(null,n)}function d(){a().next().click()}function f(t){return function(e){let i=!1;switch(e.which){case 27:r(t);break;case 38:a().prev().click(),i=!0;break;case 40:d(),i=!0;break;case 37:!function(){const n=a().data("ancestor");n&&n.click()}(),i=!0;break;case 39:!function(){const n=a().data("child");n?n.children(c).first().click():d()}(),i=!0}i&&0===a().length&&n(".column").first().children().first().click(),i&&e.preventDefault()}}n.fn.millerColumns=function(i){const a={current:n=>{},breadcrumb:o,animation:l,delay:500,resetOnOutsideClick:!0};return t=n.extend(a,i),this.each(function(){const i=n(this);!function(t){const i=[];let o;for(i.push(t.children());i.length;)(o=i.shift()).children(c).each(function(c,o){const l=n(this),s=l.children(e),a=l.parent().parent();a.length&&null==l.data("ancestor")&&n(this).siblings().addBack().data("ancestor",a),s.length&&(i.push(s),n(this).data("child",s).addClass("parent")),n(this).parent(e).appendTo(t).addClass("column")})}(i),s(),i.find(c).on("click",function(e){const c=n(this);u(i);const o=c.data("child");let l=c;for(o&&o.removeClass("collapse").children().removeClass("selected");l;)l.addClass("selected").parent().removeClass("collapse"),l=l.data("ancestor");t.animation.call(this,c,i),t.breadcrumb.call(this),t.current.call(this,c,i),e.stopPropagation()}),i.on("keydown",f(i)),i.on("click",()=>{t.resetOnOutsideClick&&r(i)})})}}});
