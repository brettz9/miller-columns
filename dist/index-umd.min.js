!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).addMillerColumnPlugin=t()}(this,(function(){"use strict";var e="undefined"!=typeof document?document.currentScript:null;function t(e,{before:t,after:n,favicon:c,canvas:r,image:o=!0,acceptErrors:i}={}){return e=Array.isArray(e)?e:[e],Promise.all(e.map((e=>function(e){let s,a={};Array.isArray(e)?[s,a={}]=e:s=e;let{favicon:l=c}=a;const{before:d=t,after:u=n,canvas:f=r,image:h=o}=a;function p(){d?d.before(m):u?u.after(m):document.head.append(m)}const m=document.createElement("link");return new Promise(((e,t)=>{let n=t;if(i&&(n="function"==typeof i?n=>{i({error:n,stylesheetURL:s,options:a,resolve:e,reject:t})}:e),s.endsWith(".css")?l=!1:s.endsWith(".ico")&&(l=!0),l){if(m.rel="shortcut icon",m.type="image/x-icon",!1===h)return m.href=s,p(),void e(m);const n=document.createElement("canvas");n.width=16,n.height=16;const c=n.getContext("2d"),r=document.createElement("img");return r.addEventListener("error",(e=>{t(e)})),r.addEventListener("load",(()=>{if(!c)throw new Error("Canvas context could not be found");c.drawImage(r,0,0),m.href=f?n.toDataURL("image/x-icon"):s,p(),e(m)})),void(r.src=s)}m.rel="stylesheet",m.type="text/css",m.href=s,p(),m.addEventListener("error",(e=>{n(e)})),m.addEventListener("load",(()=>{e(m)}))}))}(e))))}
/**
   * MIT License.
   *
   * @copyright 2014 White Magic Software, Inc.
   * @copyright 2018 Brett Zamir
   */const n=new URL("../miller-columns.css","undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:e&&"SCRIPT"===e.tagName.toUpperCase()&&e.src||new URL("index-umd.min.js",document.baseURI).href).href;return async function(e,{namespace:c="miller",stylesheets:r=["@default"]}={}){let o;const i=`ul:not(.${c}-no-columns),ol:not(.${c}-no-columns)`,s="li";function a(){return e(`.${c}-column > .${c}-selected`)}function l(){const t=e(`.${c}-breadcrumbs`).empty();a().each((function(){const n=e(this);e(`<span class="${c}-breadcrumb">`).text(n.text().trim()).click((function(){n.click()})).appendTo(t)}))}function d(t,n){let r=0;(t?a().not(t):a()).each((function(){r+=e(this).outerWidth(!0)})),n.stop().animate({scrollLeft:r},o.delay,(function(){n.find(`.${c}-column:not(.${c}-collapse)`).last()[0].scrollLeft=r,o.scroll&&o.scroll.call(this,t,n)}))}function u(){e(`.${c}-column:gt(0)`).addClass(`${c}-collapse`)}function f(){return a().last()}function h(e){p(e),function(e){d(null,e)}(e)}function p(t){u(),a().removeClass(`${c}-selected`),l(),o.reset(t),o.preview&&e(`.${c}-preview`).remove()}function m(){f().next().click()}function $(t){let n,r="";return function(o){const i=o.key;let a=!1;switch(i){case"Escape":h(t);break;case"ArrowUp":f().prev().click(),a=!0;break;case"ArrowDown":m(),a=!0;break;case"ArrowLeft":!function(){const e=f().data(`${c}-ancestor`);e&&e.click()}(),a=!0;break;case"ArrowRight":!function(){const e=f().data(`${c}-child`);e?e.children(s).first().click():m()}(),a=!0;break;default:if(1===i.length){!function(e){const t=Date.now();!n||t-n<500?r+=e:r=e,n=t}(i);t.find(`${s}.${c}-selected`).last().siblings().filter((function(){return new RegExp("^"+(t=r,t.replaceAll(/[\-\[\]\{\}\(\)*+?.,\\^$\|#\s]/gv,String.raw`\$&`)),"iv").test(e(this).text().trim());var t})).first().click()}a=!0}a&&0===f().length&&e(`.${c}-column`).first().children().first().click(),a&&o.preventDefault()}}return r&&await t(r.map((e=>"@default"===e?n:e))),e.fn.millerColumns=function(t){const n={current(e){},reset(e){},preview:null,breadcrumb:l,animation:d,delay:500,resetOnOutsideClick:!0};return o=e.extend(n,t),this.each((function(){const t=e(this);!function(t){const n=[];let r;for(n.push(t.children());n.length;)r=n.shift(),r.children(s).each((function(r,o){const s=e(this),a=s.children(i),l=s.parent().parent();l.length&&null==s.data(`${c}-ancestor`)&&e(this).siblings().addBack().data(`${c}-ancestor`,l),a.length&&(n.push(a),e(this).data(`${c}-child`,a).addClass(`${c}-parent`)),e(this).parent(i).appendTo(t).addClass(`${c}-column`)}))}(t),u(),t.find(s).on("click",(function(n){const r=e(this);p(t);const i=r.data(`${c}-child`);let s=r;for(i&&i.removeClass(`${c}-collapse`).children().removeClass(`${c}-selected`);s;)s.addClass(`${c}-selected`).parent().removeClass(`${c}-collapse`),s=s.data(`${c}-ancestor`);if(o.animation.call(this,r,t),o.breadcrumb.call(this),o.current.call(this,r,t),o.preview){if(r.hasClass(`${c}-selected`)&&!r.hasClass(`${c}-parent`)){const e=o.preview.call(this,r,t);r.parent().parent().append(`<ul class="${c}-column ${c}-preview">\n                                <li>${e}</li>\n                            </ul>`)}}n.stopPropagation()})),t.on("keydown",$(t)),t.on("click",(()=>{o.resetOnOutsideClick&&h(t)}))}))},e}}));
