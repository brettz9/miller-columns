!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.MillerColumns=n()}(this,function(){"use strict";return function(t){let n;const e="ul",c="li";function i(){return t(".column > .selected")}function o(){const n=t("div.breadcrumb").empty();i().each(function(){const e=t(this);t("<span>").text(e.text().trim()).click(function(){e.click()}).appendTo(n)})}function s(e,c){let o=0;i().not(c).each(function(){o+=t(this).outerWidth(!0)}),e.stop().animate({scrollLeft:o},n.delay)}function a(){t(".column:gt(0)").addClass("collapse")}function l(){return i().last()}function r(){a(),i().removeClass("selected"),o(),n.current(void 0)}function d(){l().next().click()}function u(n){let e=!1;switch(n.which){case 27:r();break;case 38:l().prev().click(),e=!0;break;case 40:d(),e=!0;break;case 37:!function(){const t=l().data("ancestor");t&&t.click()}(),e=!0;break;case 39:!function(){const t=l().data("child");t?t.children(c).first().click():d()}(),e=!0}e&&0===l().length&&t(".column").first().children().first().click(),e&&n.preventDefault()}t.fn.millerColumns=function(i){const l={current:function(t){},breadcrumb:o,animation:s,delay:500};return n=t.extend(l,i),this.each(function(){const i=t(this);!function(n){const i=[];let o;for(i.push(n.children());i.length;)(o=i.shift()).children(c).each(function(c,o){const s=t(this),a=s.children(e),l=s.parent().parent();l.length&&null==s.data("ancestor")&&t(this).siblings().addBack().data("ancestor",l),a.length&&(i.push(a),t(this).data("child",a).addClass("parent")),t(this).parent(e).appendTo(n).addClass("column")})}(i),a(),i.find(c).on("click",function(e){const c=t(this);r();const o=c.data("child");let s=c;for(o&&o.removeClass("collapse").children().removeClass("selected");s;)s.addClass("selected").parent().removeClass("collapse"),s=s.data("ancestor");n.animation.call(this,i,c),n.breadcrumb.call(this),n.current.call(this,c),e.stopPropagation()}),i.on("keydown",u),i.on("click",r)})}}});
