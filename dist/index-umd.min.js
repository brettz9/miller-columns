!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).addMillerColumnPlugin=t()}(this,(function(){"use strict";var e="undefined"!=typeof document?document.currentScript:null;function t(e,{before:t,after:n,favicon:r,canvas:c,image:s=!0,acceptErrors:a}={}){return e=Array.isArray(e)?e:[e],Promise.all(e.map((e=>function(e){let i,l={};Array.isArray(e)?[i,l={}]=e:i=e;let{favicon:o=r}=l;const{before:d=t,after:u=n,canvas:f=c,image:p=s}=l;function h(){d?d.before(m):u?u.after(m):document.head.append(m)}const m=document.createElement("link");return new Promise(((e,t)=>{let n=t;if(a&&(n="function"==typeof a?n=>{a({error:n,stylesheetURL:i,options:l,resolve:e,reject:t})}:e),i.endsWith(".css")?o=!1:i.endsWith(".ico")&&(o=!0),o){if(m.rel="shortcut icon",m.type="image/x-icon",!1===p)return m.href=i,h(),void e(m);const n=document.createElement("canvas");n.width=16,n.height=16;const r=n.getContext("2d"),c=document.createElement("img");return c.addEventListener("error",(e=>{t(e)})),c.addEventListener("load",(()=>{if(!r)throw new Error("Canvas context could not be found");r.drawImage(c,0,0),m.href=f?n.toDataURL("image/x-icon"):i,h(),e(m)})),void(c.src=i)}m.rel="stylesheet",m.type="text/css",m.href=i,h(),m.addEventListener("error",(e=>{n(e)})),m.addEventListener("load",(()=>{e(m)}))}))}(e))))}
/**
   * MIT License.
   *
   * @copyright 2014 White Magic Software, Inc.
   * @copyright 2018 Brett Zamir
   */const n=new URL("../miller-columns.css","undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:e&&"SCRIPT"===e.tagName.toUpperCase()&&e.src||new URL("index-umd.min.js",document.baseURI).href).href;return async function(e,{namespace:r="miller",stylesheets:c=["@default"]}={}){let s;const a=`ul:not(.${r}-no-columns),ol:not(.${r}-no-columns)`,i="li";function l(){return e(`.${r}-column > .${r}-selected`)}function o(){const t=e(`.${r}-breadcrumbs`).empty();l().each((function(){const n=e(this);e(`<span class="${r}-breadcrumb">`).text(n.text().trim()).on("click",(function(){n.trigger("click")})).appendTo(t)}))}function d(t,n){let c=0;(t?l().not(t):l()).each((function(){c+=e(this).outerWidth(!0)})),n.stop().animate({scrollLeft:c},s.delay,(function(){n.find(`.${r}-column:not(.${r}-collapse)`).last()[0].scrollLeft=c,s.scroll&&s.scroll.call(this,t,n)}))}function u(t,n){const c=[];let s;for(c.push(n||t.children());c.length;)s=c.shift(),s.children(i).each((function(n,s){const i=e(this),l=i.children(a),o=i.parent().parent();o.length&&null==i.data(`${r}-ancestor`)&&e(this).siblings().addBack().data(`${r}-ancestor`,o),l.length&&(c.push(l),e(this).data(`${r}-child`,l).addClass(`${r}-parent`)),e(this).parent(a).appendTo(t).addClass(`${r}-column`)}))}function f(){e(`.${r}-column:gt(0)`).addClass(`${r}-collapse`)}function p(){return l().last()}function h(e){m(e),function(e){d(null,e)}(e)}function m(t){f(),l().removeClass(`${r}-selected`),o(),s.reset(t),s.preview&&e(`.${r}-preview`).remove()}function $(){p().next().trigger("click")}function g(t){let n,c="";return function(s){const a=s.key;let l=!1;switch(a){case"Escape":h(t);break;case"ArrowUp":p().prev().trigger("click"),l=!0;break;case"ArrowDown":$(),l=!0;break;case"ArrowLeft":!function(){const e=p().data(`${r}-ancestor`);e&&e.trigger("click")}(),l=!0;break;case"ArrowRight":!function(){const e=p().data(`${r}-child`);e?e.children(i).first().trigger("click"):$()}(),l=!0;break;default:if(1===a.length){!function(e){const t=Date.now();!n||t-n<500?c+=e:c=e,n=t}(a);t.find(`${i}.${r}-selected`).last().siblings().filter((function(){return new RegExp("^"+(t=c,t.replaceAll(/[\-\[\]\{\}\(\)*+?.,\\^$\|#\s]/gv,String.raw`\$&`)),"iv").test(e(this).text().trim());var t})).first().trigger("click")}l=!0}l&&0===p().length&&e(`.${r}-column`).first().children().first().trigger("click"),l&&s.preventDefault()}}return c&&await t(c.map((e=>"@default"===e?n:e))),e.fn.millerColumns=function(t){const n={current(e){},reset(e){},preview:null,breadcrumb:o,animation:d,delay:500,resetOnOutsideClick:!0};s=e.extend(n,t);const c=this.each((function(){const t=e(this);u(t),f(),t.find(i).on("click",(function(n){const c=e(this);m(t);const a=c.data(`${r}-child`);let i=c;for(a&&a.removeClass(`${r}-collapse`).children().removeClass(`${r}-selected`);i;)i.addClass(`${r}-selected`).parent().removeClass(`${r}-collapse`),i=i.data(`${r}-ancestor`);if(s.animation.call(this,c,t),s.breadcrumb.call(this),s.current.call(this,c,t),s.preview){if(c.hasClass(`${r}-selected`)&&!c.hasClass(`${r}-parent`)){const e=s.preview.call(this,c,t);c.parent().parent().append(`<ul class="${r}-column ${r}-preview">\n                                <li>${e}</li>\n                            </ul>`)}}n.stopPropagation()})),t[0].addEventListener("keydown",g(t)),t.on("click",(()=>{s.resetOnOutsideClick&&h(t)}))}));return c.addItem=function(t,n){const a="string"==typeof t?e(t):t,i=c;if(n){let t=n.data(`${r}-child`);t||(t=e("<ul>"),n.append(t),n.data(`${r}-child`,t).addClass(`${r}-parent`)),t.append(a)}else{const t=i.find(`.${r}-column`).first();if(t.length)t.append(a);else{const t=e("<ul>").append(a);i.append(t)}}const l=a.parent();return u(i,l),a.off("click").on("click",(function(t){const n=e(this);m(i);const c=n.data(`${r}-child`);let a=n;for(c&&c.removeClass(`${r}-collapse`).children().removeClass(`${r}-selected`);a;)a.addClass(`${r}-selected`).parent().removeClass(`${r}-collapse`),a=a.data(`${r}-ancestor`);if(s.animation.call(this,n,i),s.breadcrumb.call(this),s.current.call(this,n,i),s.preview){if(n.hasClass(`${r}-selected`)&&!n.hasClass(`${r}-parent`)){const e=s.preview.call(this,n,i);n.parent().parent().append(`<ul class="${r}-column ${r}-preview">\n                                <li>${e}</li>\n                            </ul>`)}}t.stopPropagation()})),a},c},e}}));
