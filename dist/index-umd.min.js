!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).addMillerColumnPlugin=t()}(this,(function(){"use strict";function e(e,{before:t,after:n,favicon:c,canvas:s,image:r=!0,acceptErrors:o}={}){return e=Array.isArray(e)?e:[e],Promise.all(e.map((e=>function(e){let i,l={};Array.isArray(e)?[i,l={}]=e:i=e;let{favicon:a=c}=l;const{before:d=t,after:u=n,canvas:f=s,image:h=r}=l;function m(){d?d.before(p):u?u.after(p):document.head.append(p)}const p=document.createElement("link");return new Promise(((e,t)=>{let n=t;if(o&&(n="function"==typeof o?n=>{o({error:n,stylesheetURL:i,options:l,resolve:e,reject:t})}:e),i.endsWith(".css")?a=!1:i.endsWith(".ico")&&(a=!0),a){if(p.rel="shortcut icon",p.type="image/x-icon",!1===h)return p.href=i,m(),void e(p);const n=document.createElement("canvas");n.width=16,n.height=16;const c=n.getContext("2d"),s=document.createElement("img");return s.addEventListener("error",(e=>{t(e)})),s.addEventListener("load",(()=>{if(!c)throw new Error("Canvas context could not be found");c.drawImage(s,0,0),p.href=f?n.toDataURL("image/x-icon"):i,m(),e(p)})),void(s.src=i)}p.rel="stylesheet",p.type="text/css",p.href=i,m(),p.addEventListener("error",(e=>{n(e)})),p.addEventListener("load",(()=>{e(p)}))}))}(e))))}
/**
   * MIT License.
   *
   * @copyright 2014 White Magic Software, Inc.
   * @copyright 2018 Brett Zamir
   */const t=new URL("node_modules/miller-columns/src/index.js",location),n=new URL("../miller-columns.css",t).href;return async function(t,{namespace:c="miller",stylesheets:s=["@default"]}={}){let r;const o=`ul:not(.${c}-no-columns),ol:not(.${c}-no-columns)`,i="li";function l(){return t(`.${c}-column > .${c}-selected`)}function a(){const e=t(`.${c}-breadcrumbs`).empty();l().each((function(){const n=t(this);t(`<span class="${c}-breadcrumb">`).text(n.text().trim()).click((function(){n.click()})).appendTo(e)}))}function d(e,n){let s=0;l().not(e).each((function(){s+=t(this).outerWidth(!0)})),n.stop().animate({scrollLeft:s},r.delay,(function(){n.find(`.${c}-column:not(.${c}-collapse)`).last()[0].scrollLeft=s,r.scroll&&r.scroll.call(this,e,n)}))}function u(){t(`.${c}-column:gt(0)`).addClass(`${c}-collapse`)}function f(){return l().last()}function h(e){m(e),function(e){d(null,e)}(e)}function m(e){u(),l().removeClass(`${c}-selected`),a(),r.reset(e),r.preview&&t(`.${c}-preview`).remove()}function p(){f().next().click()}function $(e){let n,s="";return function(r){const{key:o}=r;let l=!1;switch(o){case"Escape":h(e);break;case"ArrowUp":f().prev().click(),l=!0;break;case"ArrowDown":p(),l=!0;break;case"ArrowLeft":!function(){const e=f().data(`${c}-ancestor`);e&&e.click()}(),l=!0;break;case"ArrowRight":!function(){const e=f().data(`${c}-child`);e?e.children(i).first().click():p()}(),l=!0;break;default:if(1===o.length){!function(e){const t=new Date;!n||t-n<500?s+=e:s=e,n=t}(o);e.find(`${i}.${c}-selected`).last().siblings().filter((function(){return new RegExp("^"+(e=s,e.replaceAll(/[-[\]{}()*+?.,\\^$|#\s]/g,String.raw`\$&`)),"i").test(t(this).text().trim());var e})).first().click()}l=!0}l&&0===f().length&&t(`.${c}-column`).first().children().first().click(),l&&r.preventDefault()}}return s&&await e(s.map((e=>"@default"===e?n:e))),t.fn.millerColumns=function(e){const n={current(e){},reset(e){},preview:null,breadcrumb:a,animation:d,delay:500,resetOnOutsideClick:!0};return r=t.extend(n,e),this.each((function(){const e=t(this);!function(e){const n=[];let s;for(n.push(e.children());n.length;)s=n.shift(),s.children(i).each((function(s,r){const i=t(this),l=i.children(o),a=i.parent().parent();a.length&&null==i.data(`${c}-ancestor`)&&t(this).siblings().addBack().data(`${c}-ancestor`,a),l.length&&(n.push(l),t(this).data(`${c}-child`,l).addClass(`${c}-parent`)),t(this).parent(o).appendTo(e).addClass(`${c}-column`)}))}(e),u(),e.find(i).on("click",(function(n){const s=t(this);m(e);const o=s.data(`${c}-child`);let i=s;for(o&&o.removeClass(`${c}-collapse`).children().removeClass(`${c}-selected`);i;)i.addClass(`${c}-selected`).parent().removeClass(`${c}-collapse`),i=i.data(`${c}-ancestor`);if(r.animation.call(this,s,e),r.breadcrumb.call(this),r.current.call(this,s,e),r.preview){if(s.hasClass(`${c}-selected`)&&!s.hasClass(`${c}-parent`)){const t=r.preview.call(this,s,e);s.parent().parent().append(`<ul class="${c}-column ${c}-preview">\n                                <li>${t}</li>\n                            </ul>`)}}n.stopPropagation()})),e.on("keydown",$(e)),e.on("click",(()=>{r.resetOnOutsideClick&&h(e)}))}))},t}}));
